{{ 'component-facets-horizontal.css' | asset_url | stylesheet_tag }}
{{ 'component-range-slider.css' | asset_url | stylesheet_tag }}
{{ 'component-swatch.css' | asset_url | stylesheet_tag }}

<div class="collection__facets-container element--has-grid-borders portable-hide">

  <facet-filters-form class="facets facets--horiz" data-location="desktop">

    <form id="FacetFiltersForm" class="facets__form facets__form--horizontal">

      {%- if results.terms -%}
        <input type="hidden" name="q" value="{{ results.terms | escape }}">
        <input name="options[prefix]" type="hidden" value="last">
      {%- elsif results.current_vendor or results.current_type -%}
        <input type="hidden" name="q" value="{{ results.current_vendor }}{{ results.current_type }}">
      {%- endif -%}

      {%- if enable_filtering -%}

        <div class="facets__prewrapper">

          <div class="facets__wrapper" id="FacetsFilterWrapperDesktop">
            
            {%- assign color_label = settings.color_swatches_labels | split: ',' -%}

            {%- unless results.filters == empty -%}
              <p class="facets__heading text-weight--bold">{{ 'collections.refine' | t }}</p>
            {%- endunless -%}

            {%- for filter in results.filters -%}

              {%- case filter.type -%}
              
                {%- when 'boolean' or 'list' -%}
                  
                  <details id="Filter-{{ filter.param_name | handleize }}-desktop" class="disclosure-has-popup facets__disclosure js-filter" data-index="{{ forloop.index }}-deskop" {% if filter.operator == 'AND' %} data-and-operator {% endif %}>
                    <summary class="facets__summary">
                      <span class="facets__summary-text text-size--18">
                        {{ filter.label | escape }} 
                      </span>
                    </summary>
                    <div class="facets__display">
                      <div class="facets__header">
                        <span class="facets__selected no-js-hidden">
                          {{ 'collections.filters_selected' | t: count: filter.active_values.size }}
                          {%- if filter.operator == 'AND' -%}
                            <span class="facets__and-helper-text text-size--16 text-color--opacity">{{ 'collections.match_all_label' | t }}</span>
                          {%- endif -%}
                        </span>
                        <a href="{{ filter.url_to_remove }}" class="facets__reset link underlined-link js-facet-remove" data-no-instant>{{ 'collections.reset' | t }}</a>
                      </div>

                      {%- assign color_label = settings.color_swatches_labels | split: ',' -%}
                      {%- render 'filter-blocks', filter: filter, color_label: color_label, location: 'desktop', image_filter_layout: image_filter_layout -%}

                    </div>
                  </details>

                {%- when 'price_range' -%}

                  <details id="Filter-{{ filter.param_name | handleize }}-desktop" class="disclosure-has-popup facets__disclosure js-filter" data-index="{{ forloop.index }}-desktop">
                    <summary class="facets__summary">
                      <span class="facets__summary-text">
                        {{ filter.label | escape }} 
                      </span>
                    </summary>
                    <div class="facets__display">
                      <div class="facets__header">
                        {%- liquid
                          if settings.show_currency_codes
                            assign iso_code = localization.country.currency.iso_code | prepend: ' ' 
                          endif
                        -%}
                        {%- assign max_price_amount = filter.range_max | money | append: iso_code -%}
                        <span class="facets__selected">{{ "collections.max_price_html" | t: price: max_price_amount }}</span>
                        <a href="{{ filter.url_to_remove }}" class="facets__reset link underlined-link js-facet-remove" data-no-instant>{{ 'collections.reset' | t }}</a>
                      </div>

                      {%- render 'filter-price-range', filter: filter -%}

                      <div
                        id="facets-price-range-slider"
                        data-js-price-range-slider
                      ></div>
                    </div>
                  </details>

              {%- endcase -%}

            {%- endfor -%}

            <noscript>
              <button type="submit" class="facets__button button button--regular button--outline">{{ 'collections.filter_button' | t }}</button>
            </noscript>

          </div>

        </div>

      {%- endif -%}

      <div>
        {%- if enable_sorting and results.products.size != 0 -%}
          <div class="collection-filters__item sorting">
            <div class="collection-filters__field">
              <label class="collection-filters__label text-weight--bold" for="desktop-SortBy">{{ 'collections.sort_by_label' | t }}</label>
              <div class="select">
                {%- assign sort_by = results.sort_by | default: results.default_sort_by -%}
                <select name="sort_by" class="select__select collection-filters__sort" id="desktop-SortBy" aria-describedby="a11y-refresh-page-message">
                  {%- for option in results.sort_options -%}
                    <option value="{{ option.value | escape }}"{% if option.value == sort_by %} selected="selected"{% endif %}>{{ option.name | escape }}</option>
                  {%- endfor -%}
                </select>
              </div>
            </div>
            <noscript>
              <button type="submit" class="button button button--regular button--outline">{{ 'collections.sort_button' | t }}</button>
            </noscript>
          </div>
        {%- endif -%}
      </div>

    </form>

  </facet-filters-form>

  {%- render 'facets-header', results: results, offset: offset, page_size: page_size, location: 'desktop' -%}

</div>